# Extracted content
Source: subjects/Admeav/Teoria/slides/T1_Hand crafted feature extraction.pdf

### Page 1
Advanced methods of artificial vision
Chapter 1: Hand crafted feature extraction

### Page 2
Index
1.Introduction
2.Statistical descriptors
3.Local Binary Patterns
4.Histogram of Oriented Gradients
5.SIFT
6.Gabor Filters
2

### Page 3
Index
1.Introduction
2.Statistical descriptors
3.Local Binary Patterns
4.Histogram of Oriented Gradients
5.SIFT
6.Gabor Filters
3

### Page 4
What is a feature?
â€¢ A feature (also called a descriptor) is a usually numerical value that is related to some
relevant aspect of an entire image, part of an image, or a shape resulting from a
segmentation process.
â€¢ Supposedly, a feature should have close values when the relevant aspect whose
essence it is trying to capture (colour, texture, area, etc.) is similar from a human point
of view.
â€¢ Another highly desirable property of a good feature is its robustness, understood as
immunity to noise (the values of the feature should not change too much if the image
or shape on which it is calculated is affected by a moderate level of noise).
â€¢ Generally, not a single feature is associat ed with the object of interest but several or
many of them grouped together in what is known as a feature vector.
4

### Page 5
5
Feature extraction methodology
â€¢ How do we analyse the image?
â€“ Global descriptors: descripto rs for the complete image
â€“ Local descriptors:
â€¢ Rectangular blocks or patches
â€¢ Landmark extraction: Harris, SIFT,â€¦
â€¢ Descriptors
â€“ Statistical descriptors
â€“ Cooccurrence Matrix
â€“ Histograms of Oriented Gradients
â€“ Local Binary Patterns
â€“ Gabbor Filters
â€“ SIFT, SURF
â€“â€¦ .

### Page 6
Statistical descriptors
â€¢ Analyse the statistical distribution of some property for each of the pixels in the image.
â€¢ Classified into: first order methods (those based on the histogram), second order methods
(those based on co-occurrence matrices), and higher order methods.
â€¢ First-order statistics:
â€“ The normalised histogram of the image is calculated.
â€“ Properties that are obtai ned from this histogram.
6
6
Mean                Variance Skewne ss Kurtosis               Entropy

### Page 7
Co-occurrence matrix
â€¢ Histogram-based statistics have the disadvantage of losing spatial
information.
â€¢ The same information would be obtained for an image of a chessboard with
the black and white squares swapped.
â€¢ To capture the spatial dependencies of gr ey level values, which contribute
to the perception of textures present in an image, a 2D structure called co-
occurrence matrix is defined to analyse textures.
â€¢ The co-occurrence matrix ğ‘ƒáˆºğ‘–, ğ‘—áˆ» is defined by specifying a shift direction
ğ‘‘àµŒğ‘‘ áˆº ğ‘–, ğ‘—áˆ» and counting all pairs of pixels separated by d and having grey
values ğ‘– and ğ‘—.
7
https://scikit-image.org/docs/stable/user_guide/index.html

### Page 8
Co-occurrence matrix
8
8
Contrast: 0.3307
Correlation: 0.9032
Energy: 0.1323
Homogeneity: 0.8534
1 2 3 4 5 6 7 8
1
2
3
4
5
6
7
8

### Page 9
Index
1.Introduction
2.Statistical descriptors
3.Local Binary Patterns
4.Histogram of Oriented Gradients
5.SIFT
6.Gabor Filters
9

### Page 10
Local Binary Patterns(LBP)
10
Ojala T, PietikÃ¤inen M & MÃ¤enpÃ¤Ã¤ T (2002) Multiresolution gray-scale and rotation invariant texture
classification with Local Binary Patterns. IEEE Transactions on Pattern Analysis and Machine Intelligence
24(7):971-987.

### Page 11
Local Binary Patterns(LBP)
11
ğ‘ƒàµŒ 8 y  R àµŒ 1
ğ‘ƒ P is the number of neighbours and  R is the neighbourhood radius.
ğ‘ƒàµŒ 16 y  R àµŒ 2 ğ‘ƒàµŒ 8 y  R àµŒ 2

### Page 12
Local Binary Patterns(LBP)
12
Histogram of 2à¯‰ values

### Page 13
Local Binary Patterns(LBP)
13

ğ‘…ğ‘‚ğ‘…áˆºğ‘¥, ğ‘¡áˆ» performs ğ‘¡ different rotations of the ğ‘¥ bits
â€¢ e.g. 10000010, 00101000, and 00000101 are equivalent to the minimum code 00000101.
â€¢ ğ‘ƒàµŒ 8 256 different and 36 rotationally invariant LBP patterns
LBPRi (LBP Rotational Invariant)
Uniform LBP
â€¢ Objetive: to reduce the number of possible patterns to the
really discriminating ones.
â€¢ How? By analysing the uniformity (U) of the patterns :
number of transitions from 0 to 1 and 1 to 0.

### Page 14
Local Binary Patterns(LBP)
14
Uniform rotationally invariant LBP: LBPriu2
â€¢ Patterns with U=0 or U=2 are reassigned an individual pattern
code.
â€¢ All other patterns are reassigned the same code (they become
indistinguishable).
â€¢ LBP: 256 patterns, LBP Uniform: (58 + 1) patterns, (9+1)
rotationally invariant . In general (P+2)

### Page 15
Local Binary Patterns(LBP)
15
Uniform rotationally invariant LBP: LBPriu2

### Page 16
Local Binary Patterns(LBP)
16
http://scikit-image.org/docs/dev/auto_examples/plot_local_binary_pattern.html

### Page 17
Local Binary Patterns(LBP)
17
LBP LBPri LBPriu2
LBP LBPri
LBPriu2
P=8 R=1

### Page 18
Local Binary Patterns(LBP)
18

### Page 19
Local Binary Patterns(LBP)
19
Original: i MÃ¡scara: mask Luminancia: ig LBP Histograma LBP
sana
CÃ¡ncer
grado 3
CÃ¡ncer
grado 5

### Page 20
Index
1.Introduction
2.Statistical descriptors
3.Local Binary Patterns
4.Histogram of Oriented Gradients
5.SIFT
6.Gabor Filters
20

### Page 21
Histograms of Oriented
Gradients (HOG)
â€¢ The histogram of oriented gradients (HOG ) is a widely used descriptor in image
processing for the purpose of object detection. The technique counts the occurrences of
gradient orientation in localised portions of an image.
â€¢ Algorithm:
â€“ Gradient calculation
â€“ Grouping the orientations
â€“ Block descriptor
â€“ Block normalisation
21

### Page 22
22
Convolution
7275716359626674
7275706258616572
6973696359636871
6973696259626770
7274706157596470
6869686563646668
6769696766676970
6366676564666869
-101
-202
-101
10-1
20-2
10-1
ğ‘¦ ğ‘š, ğ‘›àµŒ ğ‘¥ ğ‘š, ğ‘›âˆ— â„ğ‘š, ğ‘›àµŒ à· à· ğ‘¥ğ‘˜, ğ‘™â„ áˆ¾ ğ‘šàµ†ğ‘˜, ğ‘›àµ†ğ‘™áˆ¿
à¯Ÿà¯
Kernel
â„áˆ¾àµ†ğ‘˜, àµ†ğ‘™]â„áˆ¾ğ‘˜, ğ‘™]
àµ†1 âˆ—62 àµ…0 âˆ—59 àµ…1 âˆ—62 àµ…áˆºàµ†2áˆ»âˆ— 59 àµ…0 âˆ—57 àµ…2 âˆ—61 àµ…áˆºàµ†1áˆ»âˆ— 64 àµ…0 âˆ—63 àµ…1 âˆ—65 àµŒ 3
3
Imagen de salida
22

### Page 23
23
Gradient Computation
-101
-202
-101
121
000
-1-2-1
ğ‘€ğ‘ğ‘”ğ‘›ğ‘–ğ‘¡ğ‘¢ğ‘‘ğ‘’ àµŒ ğºà¯«à¬¶ àµ…ğºà¯¬à¬¶
ğºà¯« ğºà¯¬
ğ‘‚ğ‘Ÿğ‘–ğ‘’ğ‘›ğ‘¡ğ‘ğ‘¡ğ‘–ğ‘œğ‘› àµŒtanà¬¿à¬µ ğºà¯¬
ğºà¯« 23

### Page 24
Histograms of Oriented
Gradients (HOG)
â€¢ Division of the image into cells of fixed size.
â€¢ Calculation of a histogram of the orientations in each cell.
â€¢ Global descriptor combines histograms of all cells.
24
orientation

### Page 25
Histograms of Oriented
Gradients (HOG)
â€¢ Division of the range of orientations into a fixed number of intervals.
â€¢ Assign each pixel in the cell to an interval based on the gradient orientation.
â€¢ Accumulate the gradient magnitude of all pixels assigned to an interval.
25
orientation
orientation

### Page 26
Histograms of Oriented
Gradients (HOG)
Orientation histogram calculation: interpolation in orientation
â€¢ Problems
â€“ Gradients with very similar orientations  can be assigned to different intervals.
â€“ Sensitive to small gradient variations.
â€¢ Solution:
â€“ Assign each gradient to the two closest intervals with a we ight proportional to the distance from the orientation
to the centre of each interval.
26
orientation
orientation

### Page 27
Histograms of Oriented
Gradients (HOG)
Assign each gradient to the two closest intervals with a weight proportional to the distance from
the orientation to the centre of each interval.
ğ‘” ğ‘¥, ğ‘¦àµŒ 100
ğœƒ ğ‘¥, ğ‘¦àµŒ 45Âº
Assuming that for the histogram calculation the orientation is divided into 9 intervals (without
considering the sign), what would be the contribution of this pixel to each of the intervals of the
histogram?
27

### Page 28
Histograms of Oriented
Gradients (HOG)
Assign each gradient to the two closest intervals with a weight proportional to the distance from
the orientation to the centre of each interval.
ğ‘” ğ‘¥, ğ‘¦àµŒ 100
ğœƒ ğ‘¥, ğ‘¦àµŒ 45Âº
Assuming that for the histogram calculation the orientation is divided into 9 intervals (without
considering the sign), what would be the contribution of this pixel to each of the intervals of the
histogram?
28
00 000007525

### Page 29
Histograms of Oriented
Gradients (HOG)
29
Orientation histogram calculation: spatial integration
â€¢ A histogram is calculated for each of the cells.
â€¢ Each pixel contributes to the histogram of its corresponding cell.
ğ‘–
ğ‘—
1  2  3 4  5  6  7  8  9

### Page 30
Histograms of Oriented
Gradients (HOG)
30
Orientation histogram calculation: spatial integration
â€¢ Problems
â€¢ Pixels in close proximity can be assigned to different cells.
â€¢ Sensitive to small variations in object shape.
â€¢ Solution:
â€¢ Assign each pixel to the four nearest cells with a weight proportional to the distance of the pixel from the centre
of each cell.
1  2  3 4  5  6  7  8  9

### Page 31
Histograms of Oriented
Gradients (HOG)
31
Given an image and the division into cells as shown and assuming that the orientation is divided
into 9 intervals without considering the sign (0Âº-180Âº), in which histograms (ğ‘–,ğ‘—) of the final
representation and in which intervals ğ‘˜ and with which weight will the pixel (ğ‘¥=12,ğ‘¦=18) with
orientation ğœƒàµŒ 60Âº contribute?

### Page 32
Histograms of Oriented
Gradients (HOG)
32
Given an image and the division into cells as shown and assuming that the orientation is divided
into 9 intervals without considering the sign (0Âº-180Âº), in which histograms (ğ‘–,ğ‘—) of the final
representation and in which intervals ğ‘˜ and with which weight will the pixel (ğ‘¥=12,ğ‘¦=18) with
orientation ğœƒàµŒ 60Âº contribute?

### Page 33
Histograms of Oriented
Gradients (HOG)
33
Block normalisation
â€¢ Grouping of cells in blocks of b x b cells.
â€¢ Single vector per block concatenating the histograms of all cells.
â€¢ Vector normalisation using the L2 norm.
ğ¶à¬µà¬µ ğ¶à¬µà¬¶
ğ¶à¬¶à¬µ ğ¶à¬¶à¬¶
ğ‘£àµŒáˆº ğ‘¥à¬µ, ğ‘¥à¬¶,â€¦, ğ‘¥à¯‡áˆ»
ğ‘£á‡± àµŒ ğ‘£
ğ‘£ à¬¶
à¬¶ àµ…ğœ€
àµŒ ğ‘£
ğ‘¥à¬µ
à¬¶ àµ…ğ‘¥à¬¶
à¬¶ àµ…â‹¯àµ…ğ‘¥ à¯‡
à¬¶ àµ…ğœ€

### Page 34
Histograms of Oriented
Gradients (HOG)
34
Final descriptor
â€¢ Block overlap.
â€¢ For each block, normalised histogram of cells.
â€¢ Final descriptor: concatenation of all block histograms
ğ»ğ‘‚ğº àµŒ áˆºğ‘¥à¬µ, ğ‘¥à¬¶â€¦ ğ‘¥à¯‡)

### Page 35
Histograms of Oriented
Gradients (HOG)
35
Final descriptor
â€¢ Each cell contributes to the description of several blocks.
â€¢ In each block with a different normalization.

### Page 36
Index
1.Introduction
2.Statistical descriptors
3.Local Binary Patterns
4.Histogram of Oriented Gradients
5.SIFT
6.Gabor Filters
36

### Page 37
37
Keypoint detector
Test image Detector: locates
single-scale or multi-
scale points of interest.
Descriptor:
Content invariant
representation
(HOG, SIFT, etc.)

### Page 38
38
Harrisâ€™ detector
ïƒº
ïƒº
ïƒº
ïƒ»
ïƒ¹
ïƒª
ïƒª
ïƒª
ïƒ«
ïƒ©
ï€½
ïƒ¥ïƒ¥
ïƒ¥ïƒ¥
ïƒïƒ
ïƒïƒ
xx
xx
x
y
x
xy
x
yx
x
x
xxx
xxx
x
N
N
N
N
)()()(
)()()(
)( 2
2
III
III
C
ïƒºïƒ»
ïƒ¹
ïƒªïƒ«
ïƒ©ï€½
2
1
Î»0
0Î»)(xCExample
General case RRC ïƒºïƒ»
ïƒ¹
ïƒªïƒ«
ïƒ©ï€½ ï€­
2
11
Î»0
0Î»)(x
1Î» 2Î»
1Î» 2Î»high and       small: edge
1Î» 2Î»small and       high: edge
1Î» 2Î»
For each pixel is calculated:
and         high: corner
and         small: flat area

### Page 39
39
Harrisâ€™ detector
â€¢ Algorithm designed for motion tracking.
â€¢ Reduces calculation time co mpared to tracking all points.
â€¢ Invariant to translation and rotation.
â€¢ Not invariant to scale changes.
â€¢ Algorithm
â€“ Reduce image noise (Gaussian filter for example).
â€“ Image gradients calculation.
â€“ Construct the matrix C for each pixel.
â€“ Obtain and analyse determinant (          ) and trace (              )
of the matrix C.
21 Î»Î» ïƒ—
 21 Î»Î» ï€«

### Page 40
40
Matching of features
Original images
Keypoints (corners)
detected with Harrisâ€™
detector

### Page 41
41
Matching of features
CORRELATION
ïƒ¥ïƒ¥
ïƒ¥
ïƒïƒ
ïƒïƒ
ï€½
2211
2211
2
2
2
1
,
21
21
)()(
)()(
),(
xx
xx
xx
xx
xx
xx
xx
NN
NN
ss
ss
R

### Page 42
42
Matching of features
Need for a robust algorithm
Search of matchings: Putative matchings

### Page 43
43
Robust estimation
RANSAC (RANdom SAmple Consensus)
Algorithm
1. Take a sample: minimum number of points to
estimate the model.
2. Look at the support of that model: number of points
below a distance t (consensusset).
3. Repeat the process for N samples and select the
model with the highest support.
4. Points with a distance less than t are
inliers.Reestimate the model with all inliers.

### Page 44
44
Example RANSAC
Initial matches
Robust estimation

### Page 45
45
RANSAC estimation: Panoramic image construction
Robust estimation

### Page 46
46
Robust estimation
RANSAC estimation: Panoramic image construction

### Page 47
47
Robust estimation
RANSAC estimation: Panoramic image construction

### Page 48
48
SIFT Detector
SIFT (Scale Invariant Feature Transform)
â€¢ Invariant descriptor to position, scale, rotation, illumination, contrast and point of
view.
â€¢ Algorithm
1. Detection of extremes in scale and space: Extract rotation and scale
invariant points of interest (keypoints).
2. Eliminate â€˜weakâ€™ keypoints.
3. Orientation assignment: Assign one or more orientations to each point of
interest.
4. Keypoint descriptor: Use local gradients at the selected scale.
D. Lowe, â€œDistinctive Image Features from Scale-Invariant  Keypointsâ€, International Journal of
Computer Vision, 60(2):91-110, 2004.

### Page 49
49
SIFT: Extrema detection
k0Ïƒ0
k1Ïƒ0
ğ· ğ‘¥, ğ‘¦, ğœàµŒ ğ¿ ğ‘¥, ğ‘¦, ğ‘˜ğœ àµ†ğ¿ ğ‘¥, ğ‘¦, ğœ
ğ¿ ğ‘¥, ğ‘¦, ğœàµŒ ğº ğ‘¥, ğ‘¦, ğœâˆ— ğ¼ ğ‘¥, ğ‘¦,
ğ‘˜à¯Œ àµŒ 2à¯Œ

### Page 50
50
SIFT: Weak keypoints elimination
(a)Image 233x189
(b) 832 extreme DoG
(c) 729 left after low contrast
thresholding
(d) 536 after Hessian ratio
Weak keypoints
â€¢ keypoints with low contrast (<0.03).
â€¢ Bad edge

### Page 51
51
SIFT Descriptor
Orientation assignment
â€¢ Histogram of gradient directions for each keypoint.
â€¢ Histogram weighted by the magnitude of the gradient and by a
Gaussian function with Ïƒ=1.5 s.
22( ,) (( 1 ,) ( 1 ,) ) (( , 1 ) ( , 1 ) )
( , ) tan 2(( ( , 1) ( , 1)) / ( ( 1, ) ( 1, )))
mxy Lx y Lx y Lxy Lxy
x ya L x y L x y L x yL x y
ï±
ï€½ï€« ï€­ ï€­ï€«ï€« ï€­ï€­
ï€½ï€« ï€­ ï€­ ï€« ï€­ ï€­
ğ¿ ğ‘¥, ğ‘¦, ğœàµŒ ğº ğ‘¥, ğ‘¦, ğœâˆ— ğ¼ ğ‘¥, ğ‘¦,
0 2 ï°

### Page 52
52
SIFT descriptor
Orientation assignment
1. 16 x16 window around each keypoint.
2. Divide into 4x4 cells.
3. Calculate the histogram in each cell (partial vote).
(8 bins)
16 histograms x 8 orientations
= 128 features

### Page 53
SIFT Detector

### Page 54
SIFT: Matching of features
Descriptor with mÃ­nimum distance
Problems with ambiguities
I1 I2
ïƒ¥
ï€½
ï€­ï€½
N
i
ii ffffSSD
1
2
2121 )(),(
f1
 f2

### Page 55
SIFT: Matching of features
Problems with ambiguities
I1 I2
f1
 f2

### Page 56
Index
1.Introduction
2.Statistical descriptors
3.Local Binary Patterns
4.Histogram of Oriented Gradients
5.SIFT
6.Gabor Filters
56

### Page 57
Gabor filters
â€¢ Bank of linear filters.
â€¢ Each filter analyzes whether there is any specific  frequency content in the image in specific
directions.
â€¢ Image analysis with Gabor filters is thought by some to be similar to perception in the human
visual system.
Source: Deep Learning: Foundations and
Concepts. Christopher M. Bishop and Hugh
Bishop
