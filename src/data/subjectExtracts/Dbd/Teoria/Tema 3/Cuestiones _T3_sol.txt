# Extracted content
Source: subjects/Dbd/Teoria/Tema 3/Cuestiones _T3_sol.pdf

### Page 1
1
Diseño y Gestión de Bases de Datos
Solución Ejercicios Tema 3
1.

• Actualización en el lugar : cuando un bloque de datos se trasfiere del bú fer al disco se graba en la
ubicación original del bloque, sobrescribiendo el valor antiguo de cualquier elemento de datos que haya
sido actualizado en el bloque.
• Actualización en la sombra: cuando un bloque de datos se trasfiere del búfer al disco se graba en una
nueva ubicación, lo que permite mantener (temporalmente) varias versiones de los bloques de datos
actualizados.
• Actualización inmediata: en esta estrategia, los bloques de datos actualizados por una transacción (en
el búfer de memoria principal) se pueden transferir a disco antes de que finalice (antes de que el usuario
confirme) la correspondiente transacción.
• Actualización diferida: en esta estrategia, los bloques de datos actualizados por una transacción  (en el
búfer de memoria principal) no se pueden transferir a disco antes de que finalice (antes de que el usuario
confirme) la correspondiente transacción.
• Estrategia no forzar: los bloques actualizados por una transacción, que no hayan sido trasferidos todavía
a disco, no serán obligatoriamente transferidos en la confirmación de la transacción.
• Estrategia forzar: los bloques actualizados por una transacción, que no hayan sido transferidos todavía
a disco, serán transferidos antes de que el SGBD confirme definitivamente la transacción.
2.
2.a.
Después del fallo se aplicará el algoritmo DESHACER/REHACER: Deshacer(T4) y Rehacer (T2).
Las transacciones T 3 y T 1 serán deshechas en el momento de la anulación  y por lo tanto cuando se
recupere el sistema del fallo no habrá que hacer nada con ellas.
2.b.
Diario:
...
[leer, T3, B]               B=15
...
[leer, T2, B]               B=15
...
[leer, T1, D]               D=20
...
[leer, T1, B]               B=18
...
[leer, T4, D]               D=20
 ...
2.c.
B: 15       D: 20
2.d.
B: 18       D: 20
![Page 1, Figure 1](../../public/subject-assets/Dbd/Teoria/Tema 3/Cuestiones _T3_sol/Cuestiones _T3_sol_page_001_img_001.png)
![Page 1, Figure 2](../../public/subject-assets/Dbd/Teoria/Tema 3/Cuestiones _T3_sol/Cuestiones _T3_sol_page_001_img_002.png)
![Page 1, Figure 3](../../public/subject-assets/Dbd/Teoria/Tema 3/Cuestiones _T3_sol/Cuestiones _T3_sol_page_001_img_003.png)
![Page 1, Figure 4](../../public/subject-assets/Dbd/Teoria/Tema 3/Cuestiones _T3_sol/Cuestiones _T3_sol_page_001_img_004.png)

### Page 2
Departamento de Sistemas Informáticos y Computación
           2
3.
3.a.
Después del fallo se aplicará el algoritmo REHACER/NO DESHACER. Hay que Rehacer (T2). T1 se confirmó
antes del último punto de control por lo que no habrá que hacer nada con ella. Los cambios de T3 y T4 no
han llegado a disco por lo que no hay que deshacer su efecto.
3.b.  A: 21    B: 5       C: 3     D: 12
3.c.  A: 21    B: 12     C: 3     D: 25
4.
 Puntos de
Control
Diario Copia de
Seguridad
Algoritmo de
 Recuperación
Inmediata-No Forzar SÍ SÍ SÍ Deshacer-Rehacer
Inmediata-Forzar NO SÍ SÍ Deshacer-No Rehacer
Diferida-No Forzar SÍ SÍ SÍ No Deshacer-Rehacer
Diferida-Forzar NO SÍ SÍ No Deshacer-No Rehacer
• De la copia de seguridad no se puede prescindir nunca ya que, en caso de fallo de la memoria
secundaria, sería necesario utilizarla para recuperar un estado consistente.
• Del diario no se puede prescindir nunca ya que sería necesario en dos casos:
o Fallo del disco : sería necesario para rehacer sobre la copia de seguridad todas las
transacciones confirmadas desde la fecha de la copia de seguridad.
o Para deshacer transacciones anuladas por el usuario (rollback) o por el sistema sin que haya
fallo del sistema.  El diario se usará para rehacer los bú feres de datos en memoria que
pudieran haber sido modificados por la transacción anulada.
• De los puntos de control se puede prescindir cuando la estrategia es forzar ya que en este caso los
cambios realizados por una transacción son bajados a disco cuando se confirma la transacción.
Cuando se establece un punto de control, los cambios realizados por transacciones confirmadas son
llevados a disco, en el caso de la estrategia forzar se sabe que, si la transacción está confirmada, estos
cambios ya están en disco.
5.
5.a.
Forzar la escritura en el diario: todas las entradas de diario correspondientes a una transacción deben
haber sido grabadas en el fichero de diario en disco antes de que la transacción sea confirmada por el SGBD.
Se ejecuta en un instante de tiempo t: t
n < t < tn+1
Escritura anticipada en el diario: antes de que un bloque actualizado por una transacción sea transferido
a disco, el contenido del bú fer de diario, que contiene las entradas correspondientes a actualizaciones del
bloque, será grabado en el fichero de diario en disco. Se ejecuta en un instante de tiempo t: tn+5 < t < tn+6
5.b.
El principio de “Forzar la escritura en el diario” asegura que después del fallo se podrá rehacer T1.
El principio de “Escritura anticipada en el diario” asegura que después del fallo se podrá deshacer T2.
![Page 2, Figure 1](../../public/subject-assets/Dbd/Teoria/Tema 3/Cuestiones _T3_sol/Cuestiones _T3_sol_page_002.png)

### Page 3
Departamento de Sistemas Informáticos y Computación
           3
6.
6.a.
La recuperación dependerá de la estrategia de actualización:
Actualización INMEDIATA-NO FORZAR→ Algoritmo DESHACER-REHACER
T1 T2 T3 T4 T5 T6 T7
Nada Nada Rehacer Deshacer Rehacer Nada Deshacer
Actualización INMEDIATA- FORZAR→ Algoritmo DESHACER-NO REHACER
T1 T2 T3 T4 T5 T6 T7
Nada Nada Nada Deshacer Nada Nada Deshacer
Actualización DIFERIDA-NO FORZAR→ Algoritmo NO DESHACER-REHACER
T1 T2 T3 T4 T5 T6 T7
Nada Nada Rehacer Nada Rehacer Nada Nada
Actualización DIFERIDA- FORZAR→ Algoritmo NO DESHACER-NO REHACER
T1 T2 T3 T4 T5 T6 T7
Nada Nada Nada Nada Nada Nada Nada

6.b.
Si se ha perdido la base de datos en disco, pero no el diario en disco, independientemente de la estrategia
de actualización, el SGBD recuperaría la copia de seguridad del instante t 0 y aplicaría los cambios realizados
por las transacciones confirmadas antes del fallo , es decir reharía T 1, T3 y T5 usando para ello el diario en
disco. Con el resto de transacciones no habría que hacer nada ya que no han dejado rastro en la copia de la
base de datos que es anterior a que se iniciaran estas transacciones.

6.c.
Si se ha perdido la base de datos en disco y también el diario en disco, independientemente de la
estrategia de actualización , el SGBD recuperaría la copia de seguridad del instante t 0 no pudiendo rehacer
ninguna transacción de las confirmadas después del instante t0 ya que no hay información que lo permita (el
diario se ha perdido).
7.
7.a.
  Inmediata-No Forzar Inmediata-Forzar Diferida-No Forzar Diferida-Forzar
Tiempo Op. Búfer Disco Búfer Disco Búfer Disco Búfer Disco
t0 r1(X) 5 5 5 5 5 5 5 5
t1 X←X+3
t2 w1(X) 8 5,8 8 5,8 8 5 8 5
t3 c1 8 5,8 8 8 8 5,8 8 8
t4 r2(X) 8 5,8 8 8 8 5,8 8 8
t5 X←7
t6 w2(X) 7 5,8,7 7 8,7 7 5,8 7 8
7.b.
  Inmediata-No Forzar Inmediata-Forzar Diferida-No Forzar Diferida-Forzar
Tiempo Op. T1 T2 T1 T2 T1 T2 T1 T2
t7 Fallo Rehacer Deshacer Nada Deshacer Rehacer Nada Nada Nada
7.c.
 Inmediata-No Forzar Inmediata-Forzar Diferida-No Forzar Diferida-Forzar
Tiempo Búfer Disco Búfer Disco Búfer Disco Búfer Disco
t8  8  8  8  8
![Page 3, Figure 1](../../public/subject-assets/Dbd/Teoria/Tema 3/Cuestiones _T3_sol/Cuestiones _T3_sol_page_003.png)
