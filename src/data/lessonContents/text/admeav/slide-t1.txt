# T1 · Hand-Crafted Feature Extraction (Extracción manual de características)

## Purpose / Propósito
- Introduce the classical descriptors that support computer vision pipelines before deep models. / Introducir los descriptores clásicos que sustentan pipelines de visión por computador antes de modelos profundos.
- Show how representation choices impact discrimination, robustness, and complexity. / Mostrar cómo las decisiones de representación influyen en discriminación, robustez y complejidad.

## Objectives / Objetivos
- Differentiate between global, local, and keypoint-based descriptors. / Diferenciar descriptores globales, locales y basados en puntos clave.
- Review first- and second-order statistics used to characterize textures. / Revisar estadísticas de primer y segundo orden para caracterizar texturas.
- Understand how LBP, HOG, SIFT, Gabor filters, and corner detectors work. / Comprender el funcionamiento de LBP, HOG, SIFT, filtros de Gabor y detectores de esquinas.
- Evaluate the strengths and limitations of hand-crafted features. / Evaluar ventajas y limitaciones de las características diseñadas manualmente.

## Activities / Actividades
### Session Flow (Flujo de la sesión)
- General presentation of descriptors and foundational review. / Presentación general de descriptores y repaso de fundamentos.
- Analysis of classical statistics (first and second order) and their interpretation. / Análisis de estadísticos clásicos (primer y segundo orden) y su interpretación.
- Deep dive into LBP, HOG, SIFT, Gabor filter banks, and the Harris corner detector. / Profundización en LBP, HOG, SIFT, bancos de Gabor y detector de esquinas de Harris.
- Discussion of end-to-end pipelines: detection → description → aggregation. / Discusión sobre pipelines completos: detección → descripción → agregación.

### Concept Notes (Notas conceptuales)
#### What is a Feature? (¿Qué es una característica?)
- Numerical value that captures color, texture, or shape of an image or region. / Valor numérico que captura color, textura o forma de una imagen o región.
- Must be **discriminative** and **robust** against noise and moderate changes. / Debe ser **discriminativa** y **robusta** frente a ruido y cambios moderados.
- Combined into **feature vectors** to describe objects or scenes. / Se combinan en **vectores de características** para describir objetos o escenas.

#### Extraction Methodology (Metodología de extracción)
- **Global descriptors / Descriptores globales:** color histograms and geometric moments. / **Descriptores globales:** histogramas de color, momentos geométricos.
- **Local descriptors / Descriptores locales:** regular patches or landmarks (Harris, DoG) followed by description. / **Descriptores locales:** parches regulares o landmarks (Harris, DoG) seguidos de descripción.
- Typical pipeline: detection → description → aggregation (bag-of-words, concatenation). / Pipeline típico: detección → descripción → agregación (bag-of-words, concatenación).

#### Classical Statistics (Estadísticos clásicos)
- **First order / Primer orden:** mean, variance, skewness, kurtosis, entropy. / **Primer orden:** media, varianza, asimetría, curtosis, entropía.
- **Second order / Segundo orden:** co-occurrence matrices P(i, j; d) counting pixel pairs separated by vector d. / **Segundo orden:** matrices de co-ocurrencias P(i, j; d) que cuentan pares separados por un vector d.
- **Higher orders / Órdenes superiores:** models built on cumulants or centralized moments. / **Órdenes superiores:** modelos basados en cumulantes o momentos centralizados.

### Descriptor Highlights (Destacados de descriptores)
#### Local Binary Patterns (Patrones Binarios Locales)
- Compare each pixel with its neighbors, assigning 1/0 to form pattern histograms. / Comparan cada píxel con sus vecinos asignando 1/0 y generan histogramas de patrones.
- Common parameters: P = 8, R = 1; P = 16, R = 2; P = 8, R = 2. / Parámetros comunes: P = 8, R = 1; P = 16, R = 2; P = 8, R = 2.
- Rotations using ROR(x, t) reduce 256 patterns to 36 invariant classes. / Rotaciones mediante ROR(x, t) reducen 256 patrones a 36 clases invariantes.
- Variants: **LBPri** (rotation invariant) and **LBPriu2** (uniform patterns with at most two transitions). / Variantes: **LBPri** (invariante a rotación) y **LBPriu2** (patrones uniformes de máximo dos transiciones).

#### Histogram of Oriented Gradients (Histogramas de gradientes orientados)
1. Compute gradients with Sobel filters. / Calcular gradientes con filtros Sobel.
2. Group orientations into per-cell histograms and distribute contributions via angular interpolation. / Agrupar orientaciones en histogramas por celda y distribuir contribuciones por interpolación angular.
3. Integrate spatially using bilinear interpolation. / Integrar espacialmente aplicando interpolación bilineal.
4. Normalize blocks (L2) and concatenate to obtain the global descriptor. / Normalizar bloques (L2) y concatenar para obtener el descriptor global.
- Example of the initial convolution: central pixel ≈ 3 after applying horizontal Sobel to the 8×8 patch. / Ejemplo de convolución inicial: píxel central ≈ 3 tras aplicar Sobel horizontal al parche 8×8.
- Advantages: highly sensitive to edges, popular for pedestrian and rigid object detection. / Ventajas: alta sensibilidad a bordes, popular en detección de peatones y objetos rígidos.

#### Scale-Invariant Feature Transform (SIFT)
- Detects keypoints via Difference of Gaussians and locates sub-pixel extrema. / Detecta puntos clave mediante diferencias de gaussianas; localiza extremos subpíxel.
- Assigns a dominant orientation and integrates local histograms (classic 128 dimensions). / Asigna orientación dominante e integra histogramas locales (128 dimensiones clásicas).
- Key formulas / Fórmulas clave:
  - D(x, y, σ) = L(x, y, kσ) - L(x, y, σ)
  - L(x, y, σ) = G(x, y, σ) * I(x, y)
  - m(x, y) = √((L(x + 1, y) - L(x - 1, y))² + (L(x, y + 1) - L(x, y - 1))²)
  - θ(x, y) = atan2(L(x, y + 1) - L(x, y - 1), L(x + 1, y) - L(x - 1, y))
- Matching via SSD distance and robust filtering (e.g., RANSAC). / Emparejamiento con distancia SSD y filtrado robusto (p.ej., RANSAC).

#### Gabor Filters (Filtros de Gabor)
- Sinusoids modulated by Gaussians that respond to specific frequencies and orientations. / Senoides moduladas por gaussianas que responden a frecuencias y orientaciones específicas.
- Useful in facial recognition, texture analysis, and biometrics. / Útiles en reconocimiento facial, análisis de texturas y biometría.

#### Harris Corner Detector (Detector de esquinas de Harris)
- Structure matrix: C(x) = Σ_{(u,v)∈Nₓ} \begin{bmatrix} Iₓ² & Iₓ I_y \\ Iₓ I_y & I_y² \end{bmatrix}. / Matriz de estructura: C(x) = Σ_{(u,v)∈Nₓ} \begin{bmatrix} Iₓ² & Iₓ I_y \\ Iₓ I_y & I_y² \end{bmatrix}
- Interpretation / Interpretación:
  - Large λ₁ and λ₂ ⇒ corner. / λ₁ y λ₂ grandes ⇒ esquina.
  - Large λ₁, small λ₂ ⇒ edge. / λ₁ grande, λ₂ pequeño ⇒ borde.
  - Both small ⇒ flat region. / Ambos pequeños ⇒ región plana.
- Factorization: C(x) = R⁻¹ diag(λ₁, λ₂) R. / Factorización: C(x) = R⁻¹ diag(λ₁, λ₂) R.

### Visual Resources (Recursos visuales)
- ![Classic descriptor overview / Panorama de descriptores clásicos](figure:admeav/t1-taxonomy)
  Caption: Relationship between global, local, and keypoint-based descriptors. / Relación entre descriptores globales, locales y basados en puntos clave.

## Assessment / Evaluación
- Complete a short quiz on descriptor types and statistics after the session. / Resolver un quiz breve sobre tipos de descriptores y estadísticos tras la sesión.
- Prepare a comparative summary (half a page) explaining which descriptor you would apply to a specific problem. / Preparar un resumen comparativo (media página) explicando qué descriptor aplicarías a un problema concreto.
- Practice detection and description exercises in the lab to consolidate concepts. / Practicar con ejercicios de detección y descripción en el laboratorio para consolidar conceptos.
